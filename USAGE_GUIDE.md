# 手术排班管理系统 - 使用指南

## 📋 目录

1. [快速开始](#快速开始)
2. [功能说明](#功能说明)
3. [界面介绍](#界面介绍)
4. [常见问题](#常见问题)

## 🚀 快速开始

### 环境要求

- Node.js 16+ 
- npm 或 yarn

### 安装步骤

```bash
# 1. 安装依赖
npm install

# 2. 启动开发服务器
npm start

# 3. 打开浏览器访问
# http://localhost:4200
```

### 首次使用

系统会自动加载模拟数据，包含近两周的手术排班记录。您可以：
- 查看现有排班
- 创建新排班
- 编辑或删除排班
- 使用筛选功能

## 📱 功能说明

### 1. 日历视图

**功能特性：**
- 📅 月视图/周视图/日视图切换
- 🎨 不同状态用不同颜色标识
- 🖱️ 点击事件查看详情
- 📌 双击空白区域快速创建
- 🔄 拖拽调整时间

**操作方式：**
1. **切换视图**：点击右上角的"月/周/日"按钮
2. **查看详情**：点击日历中的任意排班卡片
3. **快速创建**：双击或选择日历空白时间段
4. **调整时间**：按住排班卡片拖拽到新位置

**状态颜色：**
- 🔵 **蓝色** - 已安排：手术已安排但未开始
- 🟢 **绿色** - 进行中：手术正在进行
- ⚫ **灰色** - 已完成：手术已完成
- 🔴 **红色** - 已取消：手术已取消

### 2. 列表视图

**功能特性：**
- 📊 表格形式展示所有排班
- 🔍 支持排序和分页
- ✏️ 快速编辑和删除
- 📄 清晰的数据展示

**操作方式：**
1. 点击工具栏的"列表视图"按钮切换
2. 点击表头进行排序
3. 使用分页控件浏览数据
4. 点击"编辑"或"删除"按钮操作单条记录

### 3. 筛选功能

**筛选条件：**
- 📅 **日期范围**：选择开始和结束日期
- 👨‍⚕️ **医生**：按主刀医生筛选
- 🏥 **手术室**：按手术室筛选
- 🏷️ **状态**：多选状态筛选
- 🔬 **手术类型**：按手术类型筛选

**使用技巧：**
- 筛选条件会自动应用（300ms 防抖）
- 点击"重置"清除所有筛选
- 点击"收起/展开"折叠筛选器
- 多个条件同时生效（AND 逻辑）

### 4. 创建/编辑排班

**必填信息：**
- ✅ 患者姓名（至少2个字符）
- ✅ 手术类型
- ✅ 主刀医生
- ✅ 手术室
- ✅ 开始时间
- ✅ 结束时间
- ✅ 状态

**可选信息：**
- 助理医生（可多选）
- 备注信息

**验证规则：**
- 结束时间必须晚于开始时间
- 自动检测时间冲突（同一手术室）
- 所有必填字段必须填写

**创建方式：**
1. **按钮创建**：点击"新建排班"按钮
2. **快速创建**：在日历中双击或选择时间段

### 5. 时间冲突检测

系统会自动检测以下冲突：
- ⚠️ 同一手术室在相同时间段的排班
- ⚠️ 时间段重叠的判断

**冲突处理：**
- 创建/编辑时自动检测
- 拖拽调整时实时检测
- 有冲突时显示警告并阻止保存

## 🖥️ 界面介绍

### 布局结构

```
┌─────────────────────────────────────┐
│         手术排班管理系统               │
├─────────────────────────────────────┤
│   [筛选条件区域] [收起/展开]          │
│   日期 | 医生 | 手术室 | 状态 | 类型  │
├─────────────────────────────────────┤
│ [新建排班]           [日历|列表视图]  │
├─────────────────────────────────────┤
│                                     │
│         日历视图 / 列表视图           │
│                                     │
│                                     │
└─────────────────────────────────────┘
```

### 快捷操作

| 操作 | 方式 |
|------|------|
| 新建排班 | 点击"新建排班"按钮 或 双击日历空白区 |
| 编辑排班 | 点击日历事件 或 列表中的"编辑" |
| 删除排班 | 在编辑弹窗中点击"删除" 或 列表中的"删除" |
| 调整时间 | 拖拽日历中的排班卡片 |
| 切换视图 | 点击"日历视图"/"列表视图"按钮 |
| 筛选数据 | 使用顶部筛选器 |
| 重置筛选 | 点击"重置"按钮 |

## 🔧 常见问题

### Q1: 如何清空所有数据？

打开浏览器开发者工具（F12），在 Console 中执行：
```javascript
localStorage.removeItem('surgery_schedules');
location.reload();
```

### Q2: 如何重新加载模拟数据？

执行上述清空操作后，刷新页面即可重新生成模拟数据。

### Q3: 拖拽不生效？

确保：
1. 日历视图处于激活状态
2. 排班状态允许编辑
3. 目标时间段无冲突

### Q4: 为什么提示时间冲突？

系统检测到同一手术室在相同时间段已有排班。请：
1. 选择其他手术室
2. 调整时间段
3. 或编辑/删除冲突的排班

### Q5: 如何导出数据？

当前版本数据存储在 localStorage 中。可以通过浏览器开发者工具：
```javascript
// 获取数据
const data = localStorage.getItem('surgery_schedules');
console.log(JSON.parse(data));

// 复制到剪贴板
copy(data);
```

### Q6: 移动端如何使用？

系统支持响应式设计：
- 筛选器自动折叠
- 表格横向滚动
- 按钮和表单自适应
- 日历视图优化显示

### Q7: 如何批量导入数据？

在开发者工具 Console 中：
```javascript
// 准备数据
const schedules = [
  {
    id: 'xxx',
    patientName: '张三',
    surgeryType: '阑尾切除术',
    // ... 其他字段
  }
];

// 导入
localStorage.setItem('surgery_schedules', JSON.stringify(schedules));
location.reload();
```

## 📊 技术信息

### 数据存储

- 使用浏览器 localStorage
- 数据 key: `surgery_schedules`
- 自动序列化/反序列化 JSON
- 日期字段自动转换

### 性能优化

- 300ms 防抖处理筛选
- RxJS 状态管理
- 按需加载数据
- 虚拟滚动支持（大数据量）

### 浏览器兼容

- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

## 🤝 反馈与支持

如遇到问题或有改进建议，欢迎：
- 提交 Issue
- 发送邮件
- 提交 Pull Request

---

**祝您使用愉快！** 🎉
